---
title: 不同指令集立即数操作比较
tags: [Study]
categories: Study
mathjax: true
---

### 不同指令集立即数操作比较

指令集：RISC-V、intel 64、IA-32、ARM

相关文档：

#### 总述

RISC-V、Intel 64、IA-32和ARM在设计理念、功能和性能等方面都存在一些区别。以下是它们之间的主要区别：

1. 设计理念：
   - RISC-V采用了精简指令集的设计理念，旨在简化指令集并提高效率。
   - Intel 64和IA-32采用了复杂指令集的设计理念，其指令集更加复杂但功能更加强大。
   - ARM指令集则采用了类RISC的设计理念，旨在保持精简但仍提供足够的功能。
2. 架构：
   - RISC-V和ARM都是基于精简指令集（RISC）的架构。
   - Intel 64和IA-32则是基于复杂指令集（CISC）的架构，CISC架构的处理器通常有更多的指令和寄存器。
   - RISC架构的处理器则倾向于更少的指令和寄存器。
3. 性能：由于指令集的设计和处理器架构的差异，这些指令集的性能也会有所不同。
   - RISC-V和ARM处理器通常具有更低的功耗和更高的性能。
   - Intel 64和IA-32处理器则更适合高性能计算和大型服务器。
4. 开放性：
   - RISC-V是一个开放的指令集架构，可以自由使用和修改。
   - ARM指令集也是开放的，但需要遵循ARM的许可协议。
   - Intel 64和IA-32则是专有的指令集架构，只能由Intel授权使用。

总体而言，每个指令集都有其独特的优势和适用场景。RISC-V和ARM适合轻量级应用和嵌入式系统，而Intel 64和IA-32则更适合需要高性能计算和大型服务器。

#### 立即数指令设计差异

1. ARM指令集：ARM指令集支持多种不同大小的立即数，并且这些立即数可以用于大多数指令。具体而言，立即数的大小可以是**8位或12位**，并且可以通过左移或符号扩展来进行填充。此外，ARM指令集还提供了一些专门的指令来**加载立即数**，如**LDR和MOV**。

​		对于立即数的使用，在文档**《REF07-ARM-Instruction Set》**中**第21页**，关于寻址方式中有提到，原文是：

```
For the word and unsigned byte instructions, the immediate offset is a 12-bit number. 
For the halfword and signed byte instructions, it is an 8-bit number.
```

​		大概意思就是在寻址的时候，如果偏移量（offset）是立即数（immediate），对于单词和无符号字节指令，直接偏移量是一个12位的数字。对于半字和有符号的字节指令，它是一个8位的数字。

​		在前面文档的**第2页**，也有对ARM指令集的摘要，其中immediate所占的位数为8位和12位。

![](image-20230324191241425.png)

​		其中便有专门的指令来**加载立即数**，如**LDR和MOV**

1. RISC-V指令集：RISC-V指令集支持立即数操作，并且可以将立即数作为指令的一部分进行编码。具体而言，RISC-V的立即数可以是5位、12位或20位，并且可以用于大多数指令。RISC-V还提供了专门的指令来加载立即数，如ADDI和LUI。

​		对于RISC-V指令集，在文档**《REF01-RISCV-SPEC-20191213》**的**第16页**，**2.3章节**中，有关 **Immediate Encoding Variants**的讲解中有相关描述。

​		![](image-20230324192904355.png)

1. Intel 64和IA-32指令集：Intel 64和IA-32指令集支持使用立即数作为指令的操作数，但是立即数的大小受到限制。具体而言，Intel 64和IA-32只支持8位或32位的立即数，并且立即数必须作为指令的一部分进行编码。

   在文档**《REF04-IA-32 Arch Soft Dev Manual》**中，**第82页**，在**章节3.7.1**中有这样的描述

   原文：

   ```
   The maximum value allowed for an immediate operand varies among instructions, but can never be greater than the maximum value of an unsigned doubleword integer.
   ```

   大概意思就是说，所有算术指令（除DIV和IDIV指令外）都允许源操作数为直接值。为直接操作数所允许的最大值随指令而变化，但永远不能大于无符号双字整数（$2^{32}$）的最大值。

